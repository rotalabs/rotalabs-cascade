
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Domain-agnostic orchestration engine for multi-stage decision routing">
      
      
      
        <link rel="canonical" href="https://rotalabs.github.io/rotalabs-cascade/tutorials/apls-learning/">
      
      
        <link rel="prev" href="../basic-cascade/">
      
      
        <link rel="next" href="../../api/core/">
      
      
      <link rel="icon" href="../../assets/logo-icon-light.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>APLS Learning - rotalabs-cascade</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2a3383ac.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cost-optimization-with-apls" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="rotalabs-cascade" class="md-header__button md-logo" aria-label="rotalabs-cascade" data-md-component="logo">
      
  <img src="../../assets/logo-icon-light.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            rotalabs-cascade
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              APLS Learning
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/rotalabs/rotalabs-cascade" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    rotalabs/rotalabs-cascade
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="rotalabs-cascade" class="md-nav__button md-logo" aria-label="rotalabs-cascade" data-md-component="logo">
      
  <img src="../../assets/logo-icon-light.png" alt="logo">

    </a>
    rotalabs-cascade
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/rotalabs/rotalabs-cascade" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    rotalabs/rotalabs-cascade
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../event-context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Event + Context
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basic-cascade/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic Cascade
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    APLS Learning
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    APLS Learning
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-cost-problem" class="md-nav__link">
    <span class="md-ellipsis">
      The Cost Problem
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-5-level-cost-model" class="md-nav__link">
    <span class="md-ellipsis">
      The 5-Level Cost Model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The 5-Level Cost Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#customizing-stage-costs" class="md-nav__link">
    <span class="md-ellipsis">
      Customizing Stage Costs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apls-components" class="md-nav__link">
    <span class="md-ellipsis">
      APLS Components
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#component-1-patternextractor" class="md-nav__link">
    <span class="md-ellipsis">
      Component 1: PatternExtractor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Component 1: PatternExtractor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pattern-types" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern Types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-patternextractor" class="md-nav__link">
    <span class="md-ellipsis">
      Using PatternExtractor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#learning-from-stage-executions" class="md-nav__link">
    <span class="md-ellipsis">
      Learning from Stage Executions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-migration-candidates" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Migration Candidates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-insights" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Insights
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#component-2-rulegenerator" class="md-nav__link">
    <span class="md-ellipsis">
      Component 2: RuleGenerator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Component 2: RuleGenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generating-rules-from-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Generating Rules from Patterns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rule-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Rule Templates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converting-to-routingrule" class="md-nav__link">
    <span class="md-ellipsis">
      Converting to RoutingRule
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batch-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Batch Processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exporting-to-yaml" class="md-nav__link">
    <span class="md-ellipsis">
      Exporting to YAML
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#component-3-costanalyzer" class="md-nav__link">
    <span class="md-ellipsis">
      Component 3: CostAnalyzer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Component 3: CostAnalyzer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calculating-migration-roi" class="md-nav__link">
    <span class="md-ellipsis">
      Calculating Migration ROI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migrationroi-fields" class="md-nav__link">
    <span class="md-ellipsis">
      MigrationROI Fields
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendations" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analyzing-all-candidates" class="md-nav__link">
    <span class="md-ellipsis">
      Analyzing All Candidates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ranking-by-roi" class="md-nav__link">
    <span class="md-ellipsis">
      Ranking by ROI
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#component-4-proposalmanager" class="md-nav__link">
    <span class="md-ellipsis">
      Component 4: ProposalManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Component 4: ProposalManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#proposal-lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      Proposal Lifecycle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-proposals" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Proposals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reviewing-proposals" class="md-nav__link">
    <span class="md-ellipsis">
      Reviewing Proposals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#approving-or-rejecting" class="md-nav__link">
    <span class="md-ellipsis">
      Approving or Rejecting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ab-testing" class="md-nav__link">
    <span class="md-ellipsis">
      A/B Testing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#activation-and-deprecation" class="md-nav__link">
    <span class="md-ellipsis">
      Activation and Deprecation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export-and-import" class="md-nav__link">
    <span class="md-ellipsis">
      Export and Import
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#complete-apls-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      Complete APLS Workflow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-start-with-high-confidence-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      1. Start with High-Confidence Patterns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-use-ab-testing" class="md-nav__link">
    <span class="md-ellipsis">
      2. Use A/B Testing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-monitor-detection-rate-impact" class="md-nav__link">
    <span class="md-ellipsis">
      3. Monitor Detection Rate Impact
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-set-up-automatic-pattern-expiration" class="md-nav__link">
    <span class="md-ellipsis">
      4. Set Up Automatic Pattern Expiration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-export-rules-for-code-review" class="md-nav__link">
    <span class="md-ellipsis">
      5. Export Rules for Code Review
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/config.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/context.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Context
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/event/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Event
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/plugins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plugins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/learning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Learning
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-cost-problem" class="md-nav__link">
    <span class="md-ellipsis">
      The Cost Problem
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-5-level-cost-model" class="md-nav__link">
    <span class="md-ellipsis">
      The 5-Level Cost Model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The 5-Level Cost Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#customizing-stage-costs" class="md-nav__link">
    <span class="md-ellipsis">
      Customizing Stage Costs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apls-components" class="md-nav__link">
    <span class="md-ellipsis">
      APLS Components
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#component-1-patternextractor" class="md-nav__link">
    <span class="md-ellipsis">
      Component 1: PatternExtractor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Component 1: PatternExtractor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pattern-types" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern Types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-patternextractor" class="md-nav__link">
    <span class="md-ellipsis">
      Using PatternExtractor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#learning-from-stage-executions" class="md-nav__link">
    <span class="md-ellipsis">
      Learning from Stage Executions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-migration-candidates" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Migration Candidates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-insights" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Insights
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#component-2-rulegenerator" class="md-nav__link">
    <span class="md-ellipsis">
      Component 2: RuleGenerator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Component 2: RuleGenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generating-rules-from-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Generating Rules from Patterns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rule-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Rule Templates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converting-to-routingrule" class="md-nav__link">
    <span class="md-ellipsis">
      Converting to RoutingRule
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batch-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Batch Processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exporting-to-yaml" class="md-nav__link">
    <span class="md-ellipsis">
      Exporting to YAML
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#component-3-costanalyzer" class="md-nav__link">
    <span class="md-ellipsis">
      Component 3: CostAnalyzer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Component 3: CostAnalyzer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calculating-migration-roi" class="md-nav__link">
    <span class="md-ellipsis">
      Calculating Migration ROI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migrationroi-fields" class="md-nav__link">
    <span class="md-ellipsis">
      MigrationROI Fields
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendations" class="md-nav__link">
    <span class="md-ellipsis">
      Recommendations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analyzing-all-candidates" class="md-nav__link">
    <span class="md-ellipsis">
      Analyzing All Candidates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ranking-by-roi" class="md-nav__link">
    <span class="md-ellipsis">
      Ranking by ROI
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#component-4-proposalmanager" class="md-nav__link">
    <span class="md-ellipsis">
      Component 4: ProposalManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Component 4: ProposalManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#proposal-lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      Proposal Lifecycle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-proposals" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Proposals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reviewing-proposals" class="md-nav__link">
    <span class="md-ellipsis">
      Reviewing Proposals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#approving-or-rejecting" class="md-nav__link">
    <span class="md-ellipsis">
      Approving or Rejecting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ab-testing" class="md-nav__link">
    <span class="md-ellipsis">
      A/B Testing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#activation-and-deprecation" class="md-nav__link">
    <span class="md-ellipsis">
      Activation and Deprecation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export-and-import" class="md-nav__link">
    <span class="md-ellipsis">
      Export and Import
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#complete-apls-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      Complete APLS Workflow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-start-with-high-confidence-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      1. Start with High-Confidence Patterns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-use-ab-testing" class="md-nav__link">
    <span class="md-ellipsis">
      2. Use A/B Testing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-monitor-detection-rate-impact" class="md-nav__link">
    <span class="md-ellipsis">
      3. Monitor Detection Rate Impact
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-set-up-automatic-pattern-expiration" class="md-nav__link">
    <span class="md-ellipsis">
      4. Set Up Automatic Pattern Expiration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-export-rules-for-code-review" class="md-nav__link">
    <span class="md-ellipsis">
      5. Export Rules for Code Review
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="cost-optimization-with-apls">Cost Optimization with APLS<a class="headerlink" href="#cost-optimization-with-apls" title="Permanent link">&para;</a></h1>
<p>The Adaptive Pattern Learning System (APLS) is a cost optimization framework within rotalabs-cascade that learns from expensive stage executions to generate cheaper rules. When your AI stage consistently catches similar patterns, APLS extracts those patterns and proposes rules that can be executed in earlier, cheaper stages.</p>
<h2 id="the-cost-problem">The Cost Problem<a class="headerlink" href="#the-cost-problem" title="Permanent link">&para;</a></h2>
<p>In a typical cascade system, costs vary dramatically between stages:</p>
<table>
<thead>
<tr>
<th>Stage</th>
<th>Relative Cost</th>
<th>Latency</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td>RULES</td>
<td>1x</td>
<td>~1ms</td>
<td>Deterministic checks</td>
</tr>
<tr>
<td>STATISTICAL_ML</td>
<td>5x</td>
<td>~10ms</td>
<td>Trained model inference</td>
</tr>
<tr>
<td>SINGLE_AI</td>
<td>25x</td>
<td>~100ms</td>
<td>Single LLM call</td>
</tr>
<tr>
<td>POD</td>
<td>100x</td>
<td>~500ms</td>
<td>Multi-agent deliberation</td>
</tr>
<tr>
<td>ADVERSARIAL</td>
<td>500x</td>
<td>~2000ms</td>
<td>Adversarial probing</td>
</tr>
</tbody>
</table>
<p>If 30% of your AI decisions follow predictable patterns, converting those patterns to rules could reduce costs by 95% for that traffic.</p>
<h2 id="the-5-level-cost-model">The 5-Level Cost Model<a class="headerlink" href="#the-5-level-cost-model" title="Permanent link">&para;</a></h2>
<p>APLS uses a hierarchical cost model defined in <code>CostAnalyzer</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rotalabs_cascade</span><span class="w"> </span><span class="kn">import</span> <span class="n">CostAnalyzer</span><span class="p">,</span> <span class="n">StageCost</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c1"># Default cost configuration</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">DEFAULT_STAGE_COSTS</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="s2">&quot;RULES&quot;</span><span class="p">:</span> <span class="n">StageCost</span><span class="p">(</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>        <span class="n">stage</span><span class="o">=</span><span class="s2">&quot;RULES&quot;</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>        <span class="n">base_cost</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>      <span class="c1"># Baseline cost</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>        <span class="n">latency_ms</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>        <span class="n">resource_units</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="p">),</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="s2">&quot;STATISTICAL_ML&quot;</span><span class="p">:</span> <span class="n">StageCost</span><span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>        <span class="n">stage</span><span class="o">=</span><span class="s2">&quot;STATISTICAL_ML&quot;</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>        <span class="n">base_cost</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>      <span class="c1"># 5x rules</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>        <span class="n">latency_ms</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>        <span class="n">resource_units</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="p">),</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="s2">&quot;SINGLE_AI&quot;</span><span class="p">:</span> <span class="n">StageCost</span><span class="p">(</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>        <span class="n">stage</span><span class="o">=</span><span class="s2">&quot;SINGLE_AI&quot;</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>        <span class="n">base_cost</span><span class="o">=</span><span class="mf">25.0</span><span class="p">,</span>     <span class="c1"># 25x rules</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>        <span class="n">latency_ms</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>        <span class="n">resource_units</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>    <span class="p">),</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>    <span class="s2">&quot;POD&quot;</span><span class="p">:</span> <span class="n">StageCost</span><span class="p">(</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>        <span class="n">stage</span><span class="o">=</span><span class="s2">&quot;POD&quot;</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>        <span class="n">base_cost</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span>    <span class="c1"># 100x rules</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>        <span class="n">latency_ms</span><span class="o">=</span><span class="mf">500.0</span><span class="p">,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>        <span class="n">resource_units</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>    <span class="p">),</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>    <span class="s2">&quot;ADVERSARIAL&quot;</span><span class="p">:</span> <span class="n">StageCost</span><span class="p">(</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>        <span class="n">stage</span><span class="o">=</span><span class="s2">&quot;ADVERSARIAL&quot;</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>        <span class="n">base_cost</span><span class="o">=</span><span class="mf">500.0</span><span class="p">,</span>    <span class="c1"># 500x rules</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>        <span class="n">latency_ms</span><span class="o">=</span><span class="mf">2000.0</span><span class="p">,</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>        <span class="n">resource_units</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>    <span class="p">),</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="p">}</span>
</code></pre></div>
<h3 id="customizing-stage-costs">Customizing Stage Costs<a class="headerlink" href="#customizing-stage-costs" title="Permanent link">&para;</a></h3>
<p>You can configure costs to match your actual infrastructure:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rotalabs_cascade</span><span class="w"> </span><span class="kn">import</span> <span class="n">CostAnalyzer</span><span class="p">,</span> <span class="n">StageCost</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c1"># Create analyzer with default costs</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="n">analyzer</span> <span class="o">=</span> <span class="n">CostAnalyzer</span><span class="p">()</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="c1"># Add or update a custom stage</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="n">analyzer</span><span class="o">.</span><span class="n">set_stage_cost</span><span class="p">(</span><span class="s2">&quot;CUSTOM_STAGE&quot;</span><span class="p">,</span> <span class="n">StageCost</span><span class="p">(</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>    <span class="n">stage</span><span class="o">=</span><span class="s2">&quot;CUSTOM_STAGE&quot;</span><span class="p">,</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>    <span class="n">base_cost</span><span class="o">=</span><span class="mf">15.0</span><span class="p">,</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>    <span class="n">latency_ms</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>    <span class="n">resource_units</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="p">))</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="c1"># Or initialize with all custom costs</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="n">custom_costs</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>    <span class="s2">&quot;RULES&quot;</span><span class="p">:</span> <span class="n">StageCost</span><span class="p">(</span><span class="n">stage</span><span class="o">=</span><span class="s2">&quot;RULES&quot;</span><span class="p">,</span> <span class="n">base_cost</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">latency_ms</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">resource_units</span><span class="o">=</span><span class="mf">0.1</span><span class="p">),</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>    <span class="s2">&quot;ML&quot;</span><span class="p">:</span> <span class="n">StageCost</span><span class="p">(</span><span class="n">stage</span><span class="o">=</span><span class="s2">&quot;ML&quot;</span><span class="p">,</span> <span class="n">base_cost</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">latency_ms</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">resource_units</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>    <span class="s2">&quot;AI&quot;</span><span class="p">:</span> <span class="n">StageCost</span><span class="p">(</span><span class="n">stage</span><span class="o">=</span><span class="s2">&quot;AI&quot;</span><span class="p">,</span> <span class="n">base_cost</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">latency_ms</span><span class="o">=</span><span class="mf">200.0</span><span class="p">,</span> <span class="n">resource_units</span><span class="o">=</span><span class="mf">5.0</span><span class="p">),</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="p">}</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="n">analyzer</span> <span class="o">=</span> <span class="n">CostAnalyzer</span><span class="p">(</span><span class="n">stage_costs</span><span class="o">=</span><span class="n">custom_costs</span><span class="p">)</span>
</code></pre></div>
<h2 id="apls-components">APLS Components<a class="headerlink" href="#apls-components" title="Permanent link">&para;</a></h2>
<p>The APLS system consists of four main components:</p>
<ol>
<li><strong>PatternExtractor</strong>: Learns patterns from stage failures/detections</li>
<li><strong>RuleGenerator</strong>: Converts patterns into routing rules</li>
<li><strong>CostAnalyzer</strong>: Calculates ROI for pattern migrations</li>
<li><strong>ProposalManager</strong>: Manages the human approval workflow</li>
</ol>
<h2 id="component-1-patternextractor">Component 1: PatternExtractor<a class="headerlink" href="#component-1-patternextractor" title="Permanent link">&para;</a></h2>
<p>The <code>PatternExtractor</code> observes stage executions and extracts recurring patterns that could be moved to earlier stages.</p>
<h3 id="pattern-types">Pattern Types<a class="headerlink" href="#pattern-types" title="Permanent link">&para;</a></h3>
<p>APLS extracts five types of patterns:</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>threshold</code></td>
<td>Simple value comparisons</td>
<td><code>amount &gt; 5000</code></td>
</tr>
<tr>
<td><code>correlation</code></td>
<td>Feature combinations</td>
<td><code>new_account AND high_value</code></td>
</tr>
<tr>
<td><code>reasoning</code></td>
<td>AI explanation patterns</td>
<td>Keywords and factors from AI reasoning</td>
</tr>
<tr>
<td><code>temporal</code></td>
<td>Time-based patterns</td>
<td>Peak hours, processing time thresholds</td>
</tr>
<tr>
<td><code>behavioral</code></td>
<td>Execution flow patterns</td>
<td>Stage sequences, routing decisions</td>
</tr>
</tbody>
</table>
<h3 id="using-patternextractor">Using PatternExtractor<a class="headerlink" href="#using-patternextractor" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rotalabs_cascade</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>    <span class="n">PatternExtractor</span><span class="p">,</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    <span class="n">PatternConfig</span><span class="p">,</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    <span class="n">ExecutionContext</span><span class="p">,</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    <span class="n">StageResult</span><span class="p">,</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="p">)</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="c1"># Configure the extractor</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="n">config</span> <span class="o">=</span> <span class="n">PatternConfig</span><span class="p">(</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>    <span class="n">min_confidence</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>           <span class="c1"># Minimum confidence to extract pattern</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>    <span class="n">min_samples_for_candidate</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="c1"># Samples needed before migration consideration</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>    <span class="n">max_patterns</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>            <span class="c1"># Maximum patterns to track (LRU eviction)</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>    <span class="n">pattern_ttl_hours</span><span class="o">=</span><span class="mi">168</span><span class="p">,</span>        <span class="c1"># Patterns expire after 7 days without updates</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>    <span class="n">enable_threshold_extraction</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>    <span class="n">enable_correlation_extraction</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>    <span class="n">enable_reasoning_extraction</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>    <span class="n">enable_temporal_extraction</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>    <span class="n">enable_behavioral_extraction</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="p">)</span>
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span class="c1"># Create the extractor</span>
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="n">extractor</span> <span class="o">=</span> <span class="n">PatternExtractor</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</code></pre></div>
<h3 id="learning-from-stage-executions">Learning from Stage Executions<a class="headerlink" href="#learning-from-stage-executions" title="Permanent link">&para;</a></h3>
<p>After each cascade execution, feed the results to the extractor:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">process_and_learn</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">extractor</span><span class="p">,</span> <span class="n">event_with_context</span><span class="p">):</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute cascade and learn from results.&quot;&quot;&quot;</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>    <span class="c1"># Execute the cascade</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">event_with_context</span><span class="p">)</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    <span class="c1"># Create execution context for learning</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    <span class="n">context</span> <span class="o">=</span> <span class="n">ExecutionContext</span><span class="p">(</span><span class="n">event_with_context</span><span class="p">)</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>    <span class="c1"># Learn from each stage that executed</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>    <span class="k">for</span> <span class="n">stage_name</span><span class="p">,</span> <span class="n">stage_data</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;stage_results&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>        <span class="n">stage_result</span> <span class="o">=</span> <span class="n">StageResult</span><span class="p">(</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>            <span class="n">stage_name</span><span class="o">=</span><span class="n">stage_name</span><span class="p">,</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>            <span class="n">result</span><span class="o">=</span><span class="n">stage_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">),</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>            <span class="n">confidence</span><span class="o">=</span><span class="n">stage_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;confidence&quot;</span><span class="p">),</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>            <span class="n">data</span><span class="o">=</span><span class="n">stage_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="p">{}),</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>            <span class="n">time_ms</span><span class="o">=</span><span class="n">stage_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;time_ms&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>        <span class="p">)</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>        <span class="c1"># Learn from stages that made decisions (not just passed through)</span>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>        <span class="k">if</span> <span class="n">stage_result</span><span class="o">.</span><span class="n">result</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;REJECT&quot;</span><span class="p">,</span> <span class="s2">&quot;FLAG&quot;</span><span class="p">,</span> <span class="s2">&quot;ESCALATE&quot;</span><span class="p">):</span>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>            <span class="n">pattern</span> <span class="o">=</span> <span class="n">extractor</span><span class="o">.</span><span class="n">learn_from_failure</span><span class="p">(</span>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>                <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span>
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>                <span class="n">stage</span><span class="o">=</span><span class="n">stage_name</span><span class="p">,</span>
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>                <span class="n">result</span><span class="o">=</span><span class="n">stage_result</span><span class="p">,</span>
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>            <span class="p">)</span>
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>            <span class="k">if</span> <span class="n">pattern</span><span class="p">:</span>
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Learned pattern </span><span class="si">{</span><span class="n">pattern</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">stage_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a>
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
<h3 id="getting-migration-candidates">Getting Migration Candidates<a class="headerlink" href="#getting-migration-candidates" title="Permanent link">&para;</a></h3>
<p>Once enough patterns accumulate, query for migration candidates:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># Get patterns ready for migration</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">candidates</span> <span class="o">=</span> <span class="n">extractor</span><span class="o">.</span><span class="n">get_migration_candidates</span><span class="p">(</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    <span class="n">min_confidence</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="n">min_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="p">)</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span><span class="si">}</span><span class="s2"> migration candidates&quot;</span><span class="p">)</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Pattern </span><span class="si">{</span><span class="n">pattern</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Stage: </span><span class="si">{</span><span class="n">pattern</span><span class="o">.</span><span class="n">stage</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Type: </span><span class="si">{</span><span class="n">pattern</span><span class="o">.</span><span class="n">pattern_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Confidence: </span><span class="si">{</span><span class="n">pattern</span><span class="o">.</span><span class="n">confidence</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Samples: </span><span class="si">{</span><span class="n">pattern</span><span class="o">.</span><span class="n">sample_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="getting-insights">Getting Insights<a class="headerlink" href="#getting-insights" title="Permanent link">&para;</a></h3>
<p>Get aggregated insights about learned patterns:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">insights</span> <span class="o">=</span> <span class="n">extractor</span><span class="o">.</span><span class="n">get_insights</span><span class="p">()</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total patterns: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">insights</span><span class="o">.</span><span class="n">patterns</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Migration candidates: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">insights</span><span class="o">.</span><span class="n">migration_candidates</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated cost reduction: </span><span class="si">{</span><span class="n">insights</span><span class="o">.</span><span class="n">estimated_cost_reduction</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Detection rate impact: </span><span class="si">{</span><span class="n">insights</span><span class="o">.</span><span class="n">detection_rate_impact</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="component-2-rulegenerator">Component 2: RuleGenerator<a class="headerlink" href="#component-2-rulegenerator" title="Permanent link">&para;</a></h2>
<p>The <code>RuleGenerator</code> converts extracted patterns into routing rules that can be deployed to earlier stages.</p>
<h3 id="generating-rules-from-patterns">Generating Rules from Patterns<a class="headerlink" href="#generating-rules-from-patterns" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rotalabs_cascade</span><span class="w"> </span><span class="kn">import</span> <span class="n">RuleGenerator</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="c1"># Create the generator</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="n">generator</span> <span class="o">=</span> <span class="n">RuleGenerator</span><span class="p">(</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>    <span class="n">min_confidence</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>    <span class="c1"># Minimum pattern confidence to generate rule</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>    <span class="n">min_coverage</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>     <span class="c1"># Minimum estimated coverage</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="p">)</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="c1"># Generate rules from all candidates</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="n">rules</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>    <span class="n">rule</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">generate_from_pattern</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>    <span class="k">if</span> <span class="n">rule</span><span class="p">:</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>        <span class="n">rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated rule: </span><span class="si">{</span><span class="n">rule</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Template: </span><span class="si">{</span><span class="n">rule</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Conditions: </span><span class="si">{</span><span class="n">rule</span><span class="o">.</span><span class="n">conditions</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Action: </span><span class="si">{</span><span class="n">rule</span><span class="o">.</span><span class="n">action</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="rule-templates">Rule Templates<a class="headerlink" href="#rule-templates" title="Permanent link">&para;</a></h3>
<p>The generator produces different rule templates based on pattern type:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rotalabs_cascade</span><span class="w"> </span><span class="kn">import</span> <span class="n">RuleTemplate</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="c1"># VALUE_THRESHOLD - Simple numeric comparisons</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="c1"># Generated from: threshold patterns</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="c1"># Example: value &gt;= 5000</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="c1"># MULTI_CONDITION - AND/OR combinations</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="c1"># Generated from: correlation and reasoning patterns</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="c1"># Example: new_account AND high_value AND unusual_location</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="c1"># PATTERN_MATCH - Regex matching</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="c1"># Generated from: reasoning patterns with keywords</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="c1"># Example: content MATCHES &quot;buy|sell|offer&quot;</span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="c1"># TEMPORAL - Time-based rules</span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="c1"># Generated from: temporal patterns</span>
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="c1"># Example: hour &gt;= 22 OR hour &lt;= 6</span>
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>
<a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="c1"># BEHAVIORAL - Execution flow rules</span>
<a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="c1"># Generated from: behavioral patterns</span>
<a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="c1"># Example: stage_count &gt;= 3 AND avg_confidence &lt; 0.6</span>
</code></pre></div>
<h3 id="converting-to-routingrule">Converting to RoutingRule<a class="headerlink" href="#converting-to-routingrule" title="Permanent link">&para;</a></h3>
<p>Generated rules can be converted to the cascade's native <code>RoutingRule</code> format:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># Convert GeneratedRule to RoutingRule for cascade config</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="k">for</span> <span class="n">generated_rule</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">:</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>    <span class="n">routing_rule</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">to_routing_rule</span><span class="p">(</span><span class="n">generated_rule</span><span class="p">)</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Routing rule: </span><span class="si">{</span><span class="n">routing_rule</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Type: </span><span class="si">{</span><span class="n">routing_rule</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Priority: </span><span class="si">{</span><span class="n">routing_rule</span><span class="o">.</span><span class="n">priority</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="batch-processing">Batch Processing<a class="headerlink" href="#batch-processing" title="Permanent link">&para;</a></h3>
<p>Generate rules from multiple patterns at once:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># Generate rules from all patterns</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">rules</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">generate_batch</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rules</span><span class="p">)</span><span class="si">}</span><span class="s2"> rules from </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span><span class="si">}</span><span class="s2"> patterns&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="exporting-to-yaml">Exporting to YAML<a class="headerlink" href="#exporting-to-yaml" title="Permanent link">&para;</a></h3>
<p>Export generated rules for review:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">yaml_output</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">to_yaml</span><span class="p">(</span><span class="n">rules</span><span class="p">)</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">yaml_output</span><span class="p">)</span>
</code></pre></div>
<p>Output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nt">generated_rules</span><span class="p">:</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">rule_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rule_abc123</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">threshold_AI_value</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Route when value is greater than or equal to 5000...</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">    </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value_threshold</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">    </span><span class="nt">conditions</span><span class="p">:</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">        </span><span class="nt">operator</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&gt;=&quot;</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5000</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">    </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">APPROVE</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">    </span><span class="nt">target_stage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RULES</span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">    </span><span class="nt">source_pattern_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pat_xyz</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w">    </span><span class="nt">confidence</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.92</span>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="w">    </span><span class="nt">estimated_coverage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.08</span>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="w">    </span><span class="nt">created_at</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;2024-01-15T10:30:00+00:00&#39;</span>
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="w">  </span><span class="nt">generated_at</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;2024-01-15T10:30:00+00:00&#39;</span>
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="w">  </span><span class="nt">rule_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="w">  </span><span class="nt">templates_used</span><span class="p">:</span>
<a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value_threshold</span>
<a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multi_condition</span>
</code></pre></div>
<h2 id="component-3-costanalyzer">Component 3: CostAnalyzer<a class="headerlink" href="#component-3-costanalyzer" title="Permanent link">&para;</a></h2>
<p>The <code>CostAnalyzer</code> calculates the ROI of migrating patterns to cheaper stages.</p>
<h3 id="calculating-migration-roi">Calculating Migration ROI<a class="headerlink" href="#calculating-migration-roi" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rotalabs_cascade</span><span class="w"> </span><span class="kn">import</span> <span class="n">CostAnalyzer</span><span class="p">,</span> <span class="n">MigrationROI</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="n">analyzer</span> <span class="o">=</span> <span class="n">CostAnalyzer</span><span class="p">()</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="c1"># Calculate ROI for a single pattern</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>    <span class="n">roi</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">calculate_migration_roi</span><span class="p">(</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>        <span class="n">pattern</span><span class="o">=</span><span class="n">pattern</span><span class="p">,</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>        <span class="n">target_stage</span><span class="o">=</span><span class="s2">&quot;RULES&quot;</span><span class="p">,</span>      <span class="c1"># Migrate to RULES stage</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>        <span class="n">volume</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>              <span class="c1"># Expected events per period</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>        <span class="n">migration_effort</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span>    <span class="c1"># One-time migration cost</span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>    <span class="p">)</span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pattern </span><span class="si">{</span><span class="n">pattern</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> -&gt; RULES:&quot;</span><span class="p">)</span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Current cost/item: </span><span class="si">{</span><span class="n">roi</span><span class="o">.</span><span class="n">current_cost_per_item</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Projected cost/item: </span><span class="si">{</span><span class="n">roi</span><span class="o">.</span><span class="n">projected_cost_per_item</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Cost reduction: </span><span class="si">{</span><span class="n">roi</span><span class="o">.</span><span class="n">cost_reduction_percentage</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Absolute savings: </span><span class="si">{</span><span class="n">roi</span><span class="o">.</span><span class="n">cost_reduction_absolute</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  False positive risk: </span><span class="si">{</span><span class="n">roi</span><span class="o">.</span><span class="n">false_positive_risk</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Payback items: </span><span class="si">{</span><span class="n">roi</span><span class="o">.</span><span class="n">payback_items</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Recommendation: </span><span class="si">{</span><span class="n">roi</span><span class="o">.</span><span class="n">recommendation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="migrationroi-fields">MigrationROI Fields<a class="headerlink" href="#migrationroi-fields" title="Permanent link">&para;</a></h3>
<p>The <code>MigrationROI</code> dataclass contains:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="nd">@dataclass</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">MigrationROI</span><span class="p">:</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>    <span class="n">pattern_id</span><span class="p">:</span> <span class="nb">str</span>                  <span class="c1"># Pattern being analyzed</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>    <span class="n">source_stage</span><span class="p">:</span> <span class="nb">str</span>                <span class="c1"># Current stage</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>    <span class="n">target_stage</span><span class="p">:</span> <span class="nb">str</span>                <span class="c1"># Proposed target stage</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>    <span class="n">current_cost_per_item</span><span class="p">:</span> <span class="nb">float</span>     <span class="c1"># Cost at current stage</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>    <span class="n">projected_cost_per_item</span><span class="p">:</span> <span class="nb">float</span>   <span class="c1"># Cost at target stage</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>    <span class="n">estimated_volume</span><span class="p">:</span> <span class="nb">int</span>            <span class="c1"># Expected items per period</span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>    <span class="n">cost_reduction_absolute</span><span class="p">:</span> <span class="nb">float</span>   <span class="c1"># Total savings per period</span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>    <span class="n">cost_reduction_percentage</span><span class="p">:</span> <span class="nb">float</span> <span class="c1"># Percentage reduction</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>    <span class="n">detection_rate_change</span><span class="p">:</span> <span class="nb">float</span>     <span class="c1"># Impact on detection rate</span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>    <span class="n">false_positive_risk</span><span class="p">:</span> <span class="nb">float</span>       <span class="c1"># Risk of false positives (0-1)</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>    <span class="n">payback_items</span><span class="p">:</span> <span class="nb">int</span>               <span class="c1"># Items to break even</span>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>    <span class="n">recommendation</span><span class="p">:</span> <span class="nb">str</span>              <span class="c1"># MIGRATE, MONITOR, or REJECT</span>
</code></pre></div>
<h3 id="recommendations">Recommendations<a class="headerlink" href="#recommendations" title="Permanent link">&para;</a></h3>
<p>The analyzer provides three recommendations:</p>
<ul>
<li><strong>MIGRATE</strong>: High confidence pattern with significant savings (&gt;20% reduction, &gt;80% confidence)</li>
<li><strong>MONITOR</strong>: Moderate savings or confidence, worth tracking</li>
<li><strong>REJECT</strong>: Too risky (high false positive risk) or insufficient savings (&lt;5%)</li>
</ul>
<h3 id="analyzing-all-candidates">Analyzing All Candidates<a class="headerlink" href="#analyzing-all-candidates" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># Analyze all candidates for migration to RULES</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="n">roi_results</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">analyze_all_candidates</span><span class="p">(</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>    <span class="n">candidates</span><span class="o">=</span><span class="n">candidates</span><span class="p">,</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>    <span class="n">target_stage</span><span class="o">=</span><span class="s2">&quot;RULES&quot;</span><span class="p">,</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>    <span class="n">volume</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="p">)</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="c1"># Get total potential savings</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="n">savings</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">get_total_potential_savings</span><span class="p">(</span><span class="n">roi_results</span><span class="p">)</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total potential savings: </span><span class="si">{</span><span class="n">savings</span><span class="p">[</span><span class="s1">&#39;total_absolute_savings&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average reduction: </span><span class="si">{</span><span class="n">savings</span><span class="p">[</span><span class="s1">&#39;average_reduction_percentage&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Patterns to migrate: </span><span class="si">{</span><span class="n">savings</span><span class="p">[</span><span class="s1">&#39;migrate_count&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Patterns to monitor: </span><span class="si">{</span><span class="n">savings</span><span class="p">[</span><span class="s1">&#39;monitor_count&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Patterns rejected: </span><span class="si">{</span><span class="n">savings</span><span class="p">[</span><span class="s1">&#39;reject_count&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="ranking-by-roi">Ranking by ROI<a class="headerlink" href="#ranking-by-roi" title="Permanent link">&para;</a></h3>
<p>Get the highest-impact migrations first:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># Rank by ROI (highest savings first)</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="n">ranked</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">rank_by_roi</span><span class="p">(</span><span class="n">roi_results</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Top 5 migration opportunities:&quot;</span><span class="p">)</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="k">for</span> <span class="n">roi</span> <span class="ow">in</span> <span class="n">ranked</span><span class="p">[:</span><span class="mi">5</span><span class="p">]:</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">roi</span><span class="o">.</span><span class="n">pattern_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">roi</span><span class="o">.</span><span class="n">cost_reduction_absolute</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> savings&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="component-4-proposalmanager">Component 4: ProposalManager<a class="headerlink" href="#component-4-proposalmanager" title="Permanent link">&para;</a></h2>
<p>The <code>ProposalManager</code> handles the human-in-the-loop approval workflow for generated rules.</p>
<h3 id="proposal-lifecycle">Proposal Lifecycle<a class="headerlink" href="#proposal-lifecycle" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>PENDING_REVIEW -&gt; APPROVED -&gt; TESTING -&gt; ACTIVE
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>                     |
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>                     v
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>                  REJECTED
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>ACTIVE -&gt; DEPRECATED
</code></pre></div>
<h3 id="creating-proposals">Creating Proposals<a class="headerlink" href="#creating-proposals" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rotalabs_cascade</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProposalManager</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="c1"># Create manager with optional persistence</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="n">manager</span> <span class="o">=</span> <span class="n">ProposalManager</span><span class="p">(</span><span class="n">storage_path</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./proposals&quot;</span><span class="p">))</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="c1"># Create proposals from generated rules and ROI analysis</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="k">for</span> <span class="n">rule</span><span class="p">,</span> <span class="n">roi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rules</span><span class="p">,</span> <span class="n">roi_results</span><span class="p">):</span>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>    <span class="k">if</span> <span class="n">roi</span><span class="o">.</span><span class="n">recommendation</span> <span class="o">==</span> <span class="s2">&quot;MIGRATE&quot;</span><span class="p">:</span>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>        <span class="n">proposal</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">create_proposal</span><span class="p">(</span>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>            <span class="n">rule</span><span class="o">=</span><span class="n">rule</span><span class="p">,</span>
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>            <span class="n">roi</span><span class="o">=</span><span class="n">roi</span><span class="p">,</span>
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>        <span class="p">)</span>
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created proposal </span><span class="si">{</span><span class="n">proposal</span><span class="o">.</span><span class="n">proposal_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="reviewing-proposals">Reviewing Proposals<a class="headerlink" href="#reviewing-proposals" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># Get pending proposals</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="n">pending</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">get_pending_proposals</span><span class="p">()</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="k">for</span> <span class="n">proposal</span> <span class="ow">in</span> <span class="n">pending</span><span class="p">:</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Proposal </span><span class="si">{</span><span class="n">proposal</span><span class="o">.</span><span class="n">proposal_id</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Rule: </span><span class="si">{</span><span class="n">proposal</span><span class="o">.</span><span class="n">generated_rule</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Confidence: </span><span class="si">{</span><span class="n">proposal</span><span class="o">.</span><span class="n">generated_rule</span><span class="o">.</span><span class="n">confidence</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Savings: </span><span class="si">{</span><span class="n">proposal</span><span class="o">.</span><span class="n">roi_analysis</span><span class="o">.</span><span class="n">cost_reduction_absolute</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Status: </span><span class="si">{</span><span class="n">proposal</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="approving-or-rejecting">Approving or Rejecting<a class="headerlink" href="#approving-or-rejecting" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># Approve a proposal</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="n">manager</span><span class="o">.</span><span class="n">approve</span><span class="p">(</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>    <span class="n">proposal_id</span><span class="o">=</span><span class="n">proposal</span><span class="o">.</span><span class="n">proposal_id</span><span class="p">,</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>    <span class="n">reviewer</span><span class="o">=</span><span class="s2">&quot;analyst@example.com&quot;</span><span class="p">,</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>    <span class="n">notes</span><span class="o">=</span><span class="s2">&quot;Pattern verified against historical data. Safe to proceed.&quot;</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="p">)</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="c1"># Reject a proposal</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="n">manager</span><span class="o">.</span><span class="n">reject</span><span class="p">(</span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>    <span class="n">proposal_id</span><span class="o">=</span><span class="n">other_proposal</span><span class="o">.</span><span class="n">proposal_id</span><span class="p">,</span>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>    <span class="n">reviewer</span><span class="o">=</span><span class="s2">&quot;analyst@example.com&quot;</span><span class="p">,</span>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>    <span class="n">notes</span><span class="o">=</span><span class="s2">&quot;Pattern too broad, high false positive risk in edge cases.&quot;</span>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="p">)</span>
</code></pre></div>
<h3 id="ab-testing">A/B Testing<a class="headerlink" href="#ab-testing" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c1"># Start A/B testing</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="n">manager</span><span class="o">.</span><span class="n">start_testing</span><span class="p">(</span><span class="n">proposal</span><span class="o">.</span><span class="n">proposal_id</span><span class="p">)</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="c1"># Record test results over time</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="n">manager</span><span class="o">.</span><span class="n">record_test_results</span><span class="p">(</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>    <span class="n">proposal_id</span><span class="o">=</span><span class="n">proposal</span><span class="o">.</span><span class="n">proposal_id</span><span class="p">,</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>    <span class="n">results</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>        <span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="mf">0.94</span><span class="p">,</span>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>        <span class="s2">&quot;false_positive_rate&quot;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>        <span class="s2">&quot;samples_tested&quot;</span><span class="p">:</span> <span class="mi">1500</span><span class="p">,</span>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>        <span class="s2">&quot;test_duration_hours&quot;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>    <span class="p">}</span>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="p">)</span>
</code></pre></div>
<h3 id="activation-and-deprecation">Activation and Deprecation<a class="headerlink" href="#activation-and-deprecation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1"># Activate approved and tested rule</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="n">manager</span><span class="o">.</span><span class="n">activate</span><span class="p">(</span><span class="n">proposal</span><span class="o">.</span><span class="n">proposal_id</span><span class="p">)</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="c1"># Get all active rules</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="n">active_rules</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">get_active_rules</span><span class="p">()</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="c1"># Later: deprecate if no longer needed</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="n">manager</span><span class="o">.</span><span class="n">deprecate</span><span class="p">(</span>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>    <span class="n">proposal_id</span><span class="o">=</span><span class="n">proposal</span><span class="o">.</span><span class="n">proposal_id</span><span class="p">,</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>    <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Pattern no longer relevant after model update.&quot;</span>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="p">)</span>
</code></pre></div>
<h3 id="export-and-import">Export and Import<a class="headerlink" href="#export-and-import" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c1"># Export all proposals</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="n">manager</span><span class="o">.</span><span class="n">export_proposals</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./proposals_backup.json&quot;</span><span class="p">))</span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="c1"># Import proposals</span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="n">manager</span><span class="o">.</span><span class="n">import_proposals</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./proposals_backup.json&quot;</span><span class="p">))</span>
</code></pre></div>
<h2 id="complete-apls-workflow">Complete APLS Workflow<a class="headerlink" href="#complete-apls-workflow" title="Permanent link">&para;</a></h2>
<p>Here's a complete example bringing all components together:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">rotalabs_cascade</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>    <span class="n">CascadeEngine</span><span class="p">,</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>    <span class="n">CascadeConfig</span><span class="p">,</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>    <span class="n">StageConfig</span><span class="p">,</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>    <span class="n">ExecutionContext</span><span class="p">,</span>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>    <span class="n">StageResult</span><span class="p">,</span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>    <span class="n">PatternExtractor</span><span class="p">,</span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a>    <span class="n">PatternConfig</span><span class="p">,</span>
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a>    <span class="n">RuleGenerator</span><span class="p">,</span>
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a>    <span class="n">CostAnalyzer</span><span class="p">,</span>
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a>    <span class="n">ProposalManager</span><span class="p">,</span>
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a>    <span class="n">EventWithContext</span><span class="p">,</span>
<a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a>    <span class="n">UniversalEvent</span><span class="p">,</span>
<a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a>    <span class="n">EventContext</span><span class="p">,</span>
<a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a>    <span class="n">DomainType</span><span class="p">,</span>
<a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a>    <span class="n">HistoricalContext</span><span class="p">,</span>
<a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="p">)</span>
<a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a>
<a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run_apls_workflow</span><span class="p">():</span>
<a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a>    <span class="c1"># 1. Set up the cascade engine (from previous tutorial)</span>
<a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a>    <span class="n">engine</span> <span class="o">=</span> <span class="n">create_cascade_engine</span><span class="p">()</span>
<a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a>
<a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a>    <span class="c1"># 2. Set up APLS components</span>
<a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a>    <span class="n">extractor</span> <span class="o">=</span> <span class="n">PatternExtractor</span><span class="p">(</span><span class="n">PatternConfig</span><span class="p">(</span>
<a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a>        <span class="n">min_confidence</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
<a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a>        <span class="n">min_samples_for_candidate</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-23-30" name="__codelineno-23-30" href="#__codelineno-23-30"></a>    <span class="p">))</span>
<a id="__codelineno-23-31" name="__codelineno-23-31" href="#__codelineno-23-31"></a>
<a id="__codelineno-23-32" name="__codelineno-23-32" href="#__codelineno-23-32"></a>    <span class="n">generator</span> <span class="o">=</span> <span class="n">RuleGenerator</span><span class="p">(</span><span class="n">min_confidence</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<a id="__codelineno-23-33" name="__codelineno-23-33" href="#__codelineno-23-33"></a>
<a id="__codelineno-23-34" name="__codelineno-23-34" href="#__codelineno-23-34"></a>    <span class="n">analyzer</span> <span class="o">=</span> <span class="n">CostAnalyzer</span><span class="p">()</span>
<a id="__codelineno-23-35" name="__codelineno-23-35" href="#__codelineno-23-35"></a>
<a id="__codelineno-23-36" name="__codelineno-23-36" href="#__codelineno-23-36"></a>    <span class="n">manager</span> <span class="o">=</span> <span class="n">ProposalManager</span><span class="p">(</span><span class="n">storage_path</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./proposals&quot;</span><span class="p">))</span>
<a id="__codelineno-23-37" name="__codelineno-23-37" href="#__codelineno-23-37"></a>
<a id="__codelineno-23-38" name="__codelineno-23-38" href="#__codelineno-23-38"></a>    <span class="c1"># 3. Process events and learn patterns</span>
<a id="__codelineno-23-39" name="__codelineno-23-39" href="#__codelineno-23-39"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Processing events and learning patterns...&quot;</span><span class="p">)</span>
<a id="__codelineno-23-40" name="__codelineno-23-40" href="#__codelineno-23-40"></a>
<a id="__codelineno-23-41" name="__codelineno-23-41" href="#__codelineno-23-41"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>  <span class="c1"># Simulate 100 events</span>
<a id="__codelineno-23-42" name="__codelineno-23-42" href="#__codelineno-23-42"></a>        <span class="n">event</span> <span class="o">=</span> <span class="n">generate_random_event</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-23-43" name="__codelineno-23-43" href="#__codelineno-23-43"></a>        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
<a id="__codelineno-23-44" name="__codelineno-23-44" href="#__codelineno-23-44"></a>
<a id="__codelineno-23-45" name="__codelineno-23-45" href="#__codelineno-23-45"></a>        <span class="c1"># Learn from AI stage executions</span>
<a id="__codelineno-23-46" name="__codelineno-23-46" href="#__codelineno-23-46"></a>        <span class="k">if</span> <span class="s2">&quot;AI&quot;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;stage_results&quot;</span><span class="p">]:</span>
<a id="__codelineno-23-47" name="__codelineno-23-47" href="#__codelineno-23-47"></a>            <span class="n">context</span> <span class="o">=</span> <span class="n">ExecutionContext</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
<a id="__codelineno-23-48" name="__codelineno-23-48" href="#__codelineno-23-48"></a>            <span class="n">ai_data</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;stage_results&quot;</span><span class="p">][</span><span class="s2">&quot;AI&quot;</span><span class="p">]</span>
<a id="__codelineno-23-49" name="__codelineno-23-49" href="#__codelineno-23-49"></a>            <span class="n">stage_result</span> <span class="o">=</span> <span class="n">StageResult</span><span class="p">(</span>
<a id="__codelineno-23-50" name="__codelineno-23-50" href="#__codelineno-23-50"></a>                <span class="n">stage_name</span><span class="o">=</span><span class="s2">&quot;AI&quot;</span><span class="p">,</span>
<a id="__codelineno-23-51" name="__codelineno-23-51" href="#__codelineno-23-51"></a>                <span class="n">result</span><span class="o">=</span><span class="n">ai_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">),</span>
<a id="__codelineno-23-52" name="__codelineno-23-52" href="#__codelineno-23-52"></a>                <span class="n">confidence</span><span class="o">=</span><span class="n">ai_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;confidence&quot;</span><span class="p">),</span>
<a id="__codelineno-23-53" name="__codelineno-23-53" href="#__codelineno-23-53"></a>                <span class="n">data</span><span class="o">=</span><span class="n">ai_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="p">{}),</span>
<a id="__codelineno-23-54" name="__codelineno-23-54" href="#__codelineno-23-54"></a>                <span class="n">time_ms</span><span class="o">=</span><span class="n">ai_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;time_ms&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-23-55" name="__codelineno-23-55" href="#__codelineno-23-55"></a>            <span class="p">)</span>
<a id="__codelineno-23-56" name="__codelineno-23-56" href="#__codelineno-23-56"></a>            <span class="n">extractor</span><span class="o">.</span><span class="n">learn_from_failure</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="s2">&quot;AI&quot;</span><span class="p">,</span> <span class="n">stage_result</span><span class="p">)</span>
<a id="__codelineno-23-57" name="__codelineno-23-57" href="#__codelineno-23-57"></a>
<a id="__codelineno-23-58" name="__codelineno-23-58" href="#__codelineno-23-58"></a>    <span class="c1"># 4. Get migration candidates</span>
<a id="__codelineno-23-59" name="__codelineno-23-59" href="#__codelineno-23-59"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Finding migration candidates...&quot;</span><span class="p">)</span>
<a id="__codelineno-23-60" name="__codelineno-23-60" href="#__codelineno-23-60"></a>    <span class="n">candidates</span> <span class="o">=</span> <span class="n">extractor</span><span class="o">.</span><span class="n">get_migration_candidates</span><span class="p">(</span>
<a id="__codelineno-23-61" name="__codelineno-23-61" href="#__codelineno-23-61"></a>        <span class="n">min_confidence</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
<a id="__codelineno-23-62" name="__codelineno-23-62" href="#__codelineno-23-62"></a>        <span class="n">min_samples</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-23-63" name="__codelineno-23-63" href="#__codelineno-23-63"></a>    <span class="p">)</span>
<a id="__codelineno-23-64" name="__codelineno-23-64" href="#__codelineno-23-64"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span><span class="si">}</span><span class="s2"> candidates&quot;</span><span class="p">)</span>
<a id="__codelineno-23-65" name="__codelineno-23-65" href="#__codelineno-23-65"></a>
<a id="__codelineno-23-66" name="__codelineno-23-66" href="#__codelineno-23-66"></a>    <span class="c1"># 5. Generate rules</span>
<a id="__codelineno-23-67" name="__codelineno-23-67" href="#__codelineno-23-67"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating rules...&quot;</span><span class="p">)</span>
<a id="__codelineno-23-68" name="__codelineno-23-68" href="#__codelineno-23-68"></a>    <span class="n">rules</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">generate_batch</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span>
<a id="__codelineno-23-69" name="__codelineno-23-69" href="#__codelineno-23-69"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rules</span><span class="p">)</span><span class="si">}</span><span class="s2"> rules&quot;</span><span class="p">)</span>
<a id="__codelineno-23-70" name="__codelineno-23-70" href="#__codelineno-23-70"></a>
<a id="__codelineno-23-71" name="__codelineno-23-71" href="#__codelineno-23-71"></a>    <span class="c1"># 6. Analyze ROI</span>
<a id="__codelineno-23-72" name="__codelineno-23-72" href="#__codelineno-23-72"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Analyzing ROI...&quot;</span><span class="p">)</span>
<a id="__codelineno-23-73" name="__codelineno-23-73" href="#__codelineno-23-73"></a>    <span class="n">roi_results</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">analyze_all_candidates</span><span class="p">(</span>
<a id="__codelineno-23-74" name="__codelineno-23-74" href="#__codelineno-23-74"></a>        <span class="n">candidates</span><span class="o">=</span><span class="n">candidates</span><span class="p">,</span>
<a id="__codelineno-23-75" name="__codelineno-23-75" href="#__codelineno-23-75"></a>        <span class="n">target_stage</span><span class="o">=</span><span class="s2">&quot;RULES&quot;</span><span class="p">,</span>
<a id="__codelineno-23-76" name="__codelineno-23-76" href="#__codelineno-23-76"></a>        <span class="n">volume</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-23-77" name="__codelineno-23-77" href="#__codelineno-23-77"></a>    <span class="p">)</span>
<a id="__codelineno-23-78" name="__codelineno-23-78" href="#__codelineno-23-78"></a>
<a id="__codelineno-23-79" name="__codelineno-23-79" href="#__codelineno-23-79"></a>    <span class="n">savings</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">get_total_potential_savings</span><span class="p">(</span><span class="n">roi_results</span><span class="p">)</span>
<a id="__codelineno-23-80" name="__codelineno-23-80" href="#__codelineno-23-80"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total potential savings: </span><span class="si">{</span><span class="n">savings</span><span class="p">[</span><span class="s1">&#39;total_absolute_savings&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-23-81" name="__codelineno-23-81" href="#__codelineno-23-81"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Patterns to migrate: </span><span class="si">{</span><span class="n">savings</span><span class="p">[</span><span class="s1">&#39;migrate_count&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-23-82" name="__codelineno-23-82" href="#__codelineno-23-82"></a>
<a id="__codelineno-23-83" name="__codelineno-23-83" href="#__codelineno-23-83"></a>    <span class="c1"># 7. Create proposals for MIGRATE recommendations</span>
<a id="__codelineno-23-84" name="__codelineno-23-84" href="#__codelineno-23-84"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Creating proposals...&quot;</span><span class="p">)</span>
<a id="__codelineno-23-85" name="__codelineno-23-85" href="#__codelineno-23-85"></a>    <span class="k">for</span> <span class="n">rule</span><span class="p">,</span> <span class="n">roi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rules</span><span class="p">,</span> <span class="n">roi_results</span><span class="p">):</span>
<a id="__codelineno-23-86" name="__codelineno-23-86" href="#__codelineno-23-86"></a>        <span class="k">if</span> <span class="n">roi</span><span class="o">.</span><span class="n">recommendation</span> <span class="o">==</span> <span class="s2">&quot;MIGRATE&quot;</span><span class="p">:</span>
<a id="__codelineno-23-87" name="__codelineno-23-87" href="#__codelineno-23-87"></a>            <span class="n">proposal</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">create_proposal</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">roi</span><span class="p">)</span>
<a id="__codelineno-23-88" name="__codelineno-23-88" href="#__codelineno-23-88"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Created: </span><span class="si">{</span><span class="n">proposal</span><span class="o">.</span><span class="n">proposal_id</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">rule</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-23-89" name="__codelineno-23-89" href="#__codelineno-23-89"></a>
<a id="__codelineno-23-90" name="__codelineno-23-90" href="#__codelineno-23-90"></a>    <span class="c1"># 8. Simulate human review</span>
<a id="__codelineno-23-91" name="__codelineno-23-91" href="#__codelineno-23-91"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Pending proposals for review:&quot;</span><span class="p">)</span>
<a id="__codelineno-23-92" name="__codelineno-23-92" href="#__codelineno-23-92"></a>    <span class="n">pending</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">get_pending_proposals</span><span class="p">()</span>
<a id="__codelineno-23-93" name="__codelineno-23-93" href="#__codelineno-23-93"></a>    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pending</span><span class="p">:</span>
<a id="__codelineno-23-94" name="__codelineno-23-94" href="#__codelineno-23-94"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">proposal_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">generated_rule</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-23-95" name="__codelineno-23-95" href="#__codelineno-23-95"></a>
<a id="__codelineno-23-96" name="__codelineno-23-96" href="#__codelineno-23-96"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">APLS workflow complete!&quot;</span><span class="p">)</span>
<a id="__codelineno-23-97" name="__codelineno-23-97" href="#__codelineno-23-97"></a>    <span class="k">return</span> <span class="n">manager</span>
<a id="__codelineno-23-98" name="__codelineno-23-98" href="#__codelineno-23-98"></a>
<a id="__codelineno-23-99" name="__codelineno-23-99" href="#__codelineno-23-99"></a>
<a id="__codelineno-23-100" name="__codelineno-23-100" href="#__codelineno-23-100"></a><span class="k">def</span><span class="w"> </span><span class="nf">generate_random_event</span><span class="p">(</span><span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EventWithContext</span><span class="p">:</span>
<a id="__codelineno-23-101" name="__codelineno-23-101" href="#__codelineno-23-101"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a random event for testing.&quot;&quot;&quot;</span>
<a id="__codelineno-23-102" name="__codelineno-23-102" href="#__codelineno-23-102"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<a id="__codelineno-23-103" name="__codelineno-23-103" href="#__codelineno-23-103"></a>    <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<a id="__codelineno-23-104" name="__codelineno-23-104" href="#__codelineno-23-104"></a>
<a id="__codelineno-23-105" name="__codelineno-23-105" href="#__codelineno-23-105"></a>    <span class="n">event</span> <span class="o">=</span> <span class="n">UniversalEvent</span><span class="p">(</span>
<a id="__codelineno-23-106" name="__codelineno-23-106" href="#__codelineno-23-106"></a>        <span class="nb">id</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;evt_</span><span class="si">{</span><span class="n">seed</span><span class="si">:</span><span class="s2">04d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-23-107" name="__codelineno-23-107" href="#__codelineno-23-107"></a>        <span class="n">domain</span><span class="o">=</span><span class="n">DomainType</span><span class="o">.</span><span class="n">FINANCE</span><span class="p">,</span>
<a id="__codelineno-23-108" name="__codelineno-23-108" href="#__codelineno-23-108"></a>        <span class="n">event_type</span><span class="o">=</span><span class="s2">&quot;transaction&quot;</span><span class="p">,</span>
<a id="__codelineno-23-109" name="__codelineno-23-109" href="#__codelineno-23-109"></a>        <span class="n">timestamp</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
<a id="__codelineno-23-110" name="__codelineno-23-110" href="#__codelineno-23-110"></a>        <span class="n">primary_entity</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;user_</span><span class="si">{</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-23-111" name="__codelineno-23-111" href="#__codelineno-23-111"></a>        <span class="n">secondary_entity</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;merchant_</span><span class="si">{</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-23-112" name="__codelineno-23-112" href="#__codelineno-23-112"></a>        <span class="n">value</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10000</span><span class="p">),</span>
<a id="__codelineno-23-113" name="__codelineno-23-113" href="#__codelineno-23-113"></a>        <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;USD&quot;</span><span class="p">,</span>
<a id="__codelineno-23-114" name="__codelineno-23-114" href="#__codelineno-23-114"></a>        <span class="n">domain_data</span><span class="o">=</span><span class="p">{}</span>
<a id="__codelineno-23-115" name="__codelineno-23-115" href="#__codelineno-23-115"></a>    <span class="p">)</span>
<a id="__codelineno-23-116" name="__codelineno-23-116" href="#__codelineno-23-116"></a>
<a id="__codelineno-23-117" name="__codelineno-23-117" href="#__codelineno-23-117"></a>    <span class="n">context</span> <span class="o">=</span> <span class="n">EventContext</span><span class="p">(</span>
<a id="__codelineno-23-118" name="__codelineno-23-118" href="#__codelineno-23-118"></a>        <span class="n">historical</span><span class="o">=</span><span class="n">HistoricalContext</span><span class="p">(</span>
<a id="__codelineno-23-119" name="__codelineno-23-119" href="#__codelineno-23-119"></a>            <span class="n">account_age_days</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
<a id="__codelineno-23-120" name="__codelineno-23-120" href="#__codelineno-23-120"></a>            <span class="n">previous_events_count</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span>
<a id="__codelineno-23-121" name="__codelineno-23-121" href="#__codelineno-23-121"></a>            <span class="n">trust_score</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">),</span>
<a id="__codelineno-23-122" name="__codelineno-23-122" href="#__codelineno-23-122"></a>        <span class="p">)</span>
<a id="__codelineno-23-123" name="__codelineno-23-123" href="#__codelineno-23-123"></a>    <span class="p">)</span>
<a id="__codelineno-23-124" name="__codelineno-23-124" href="#__codelineno-23-124"></a>
<a id="__codelineno-23-125" name="__codelineno-23-125" href="#__codelineno-23-125"></a>    <span class="k">return</span> <span class="n">EventWithContext</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="n">event</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
<a id="__codelineno-23-126" name="__codelineno-23-126" href="#__codelineno-23-126"></a>
<a id="__codelineno-23-127" name="__codelineno-23-127" href="#__codelineno-23-127"></a>
<a id="__codelineno-23-128" name="__codelineno-23-128" href="#__codelineno-23-128"></a><span class="c1"># Run the workflow</span>
<a id="__codelineno-23-129" name="__codelineno-23-129" href="#__codelineno-23-129"></a><span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">run_apls_workflow</span><span class="p">())</span>
</code></pre></div>
<h2 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h2>
<h3 id="1-start-with-high-confidence-patterns">1. Start with High-Confidence Patterns<a class="headerlink" href="#1-start-with-high-confidence-patterns" title="Permanent link">&para;</a></h3>
<p>Only migrate patterns with confidence &gt;= 0.8 to minimize false positives:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="n">candidates</span> <span class="o">=</span> <span class="n">extractor</span><span class="o">.</span><span class="n">get_migration_candidates</span><span class="p">(</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>    <span class="n">min_confidence</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span>  <span class="c1"># Start conservative</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>    <span class="n">min_samples</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>       <span class="c1"># Require more evidence</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="p">)</span>
</code></pre></div>
<h3 id="2-use-ab-testing">2. Use A/B Testing<a class="headerlink" href="#2-use-ab-testing" title="Permanent link">&para;</a></h3>
<p>Always test before full activation:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c1"># Test with 10% traffic first</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="n">manager</span><span class="o">.</span><span class="n">start_testing</span><span class="p">(</span><span class="n">proposal_id</span><span class="p">)</span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="c1"># ... run tests ...</span>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="n">manager</span><span class="o">.</span><span class="n">record_test_results</span><span class="p">(</span><span class="n">proposal_id</span><span class="p">,</span> <span class="p">{</span>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>    <span class="s2">&quot;traffic_percentage&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>    <span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="mf">0.96</span><span class="p">,</span>
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>    <span class="s2">&quot;false_positive_rate&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="p">})</span>
</code></pre></div>
<h3 id="3-monitor-detection-rate-impact">3. Monitor Detection Rate Impact<a class="headerlink" href="#3-monitor-detection-rate-impact" title="Permanent link">&para;</a></h3>
<p>Watch for patterns that reduce detection effectiveness:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="n">roi</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">calculate_migration_roi</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="s2">&quot;RULES&quot;</span><span class="p">,</span> <span class="n">volume</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="k">if</span> <span class="n">roi</span><span class="o">.</span><span class="n">detection_rate_change</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">:</span>  <span class="c1"># &gt;5% detection rate drop</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Migration may reduce detection by </span><span class="si">{</span><span class="o">-</span><span class="n">roi</span><span class="o">.</span><span class="n">detection_rate_change</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="4-set-up-automatic-pattern-expiration">4. Set Up Automatic Pattern Expiration<a class="headerlink" href="#4-set-up-automatic-pattern-expiration" title="Permanent link">&para;</a></h3>
<p>Patterns should expire if not seen recently:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="n">config</span> <span class="o">=</span> <span class="n">PatternConfig</span><span class="p">(</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>    <span class="n">pattern_ttl_hours</span><span class="o">=</span><span class="mi">168</span><span class="p">,</span>  <span class="c1"># 7 days</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="p">)</span>
</code></pre></div>
<h3 id="5-export-rules-for-code-review">5. Export Rules for Code Review<a class="headerlink" href="#5-export-rules-for-code-review" title="Permanent link">&para;</a></h3>
<p>Generate YAML for human review:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="n">yaml_output</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">to_yaml</span><span class="p">(</span><span class="n">rules</span><span class="p">)</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;proposed_rules.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">yaml_output</span><span class="p">)</span>
</code></pre></div>
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p>APLS provides a complete framework for learning from expensive AI decisions and migrating patterns to cheaper rule-based stages:</p>
<ol>
<li><strong>PatternExtractor</strong> learns from stage executions</li>
<li><strong>RuleGenerator</strong> converts patterns to rules</li>
<li><strong>CostAnalyzer</strong> calculates migration ROI</li>
<li><strong>ProposalManager</strong> handles human approval</li>
</ol>
<p>The result is continuous cost optimization while maintaining detection quality through human oversight and A/B testing.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <a href="https://rotalabs.ai"><img src="assets/logo-light-full.png" alt="Rotalabs" style="height: 30px; vertical-align: middle;"></a>
&nbsp;&copy; 2025 Rotalabs

    </div>
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/rotalabs/rotalabs-cascade" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/rotalabs-cascade/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://rotalabs.ai" target="_blank" rel="noopener" title="rotalabs.ai" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M351.9 280H161c2.9 64.5 17.2 123.9 37.5 167.4 11.4 24.5 23.7 41.8 35.1 52.4 11.2 10.5 18.9 12.2 22.9 12.2s11.7-1.7 22.9-12.2c11.4-10.6 23.7-28 35.1-52.4 20.3-43.5 34.6-102.9 37.5-167.4zm-191-48h190.9c-2.8-64.5-17.1-123.9-37.4-167.4-11.4-24.4-23.7-41.8-35.1-52.4C268.1 1.7 260.4 0 256.4 0s-11.7 1.7-22.9 12.2c-11.4 10.6-23.7 28-35.1 52.4-20.3 43.5-34.6 102.9-37.5 167.4m-48 0c3.5-85.6 25.6-165.1 57.9-217.3C78.7 47.3 10.9 131.2 1.5 232zM1.5 280c9.4 100.8 77.2 184.7 169.3 217.3-32.3-52.2-54.4-131.7-57.9-217.3zm398.4 0c-3.5 85.6-25.6 165.1-57.9 217.3 92.1-32.7 159.9-116.5 169.3-217.3zm111.4-48C501.9 131.2 434.1 47.3 342 14.7c32.3 52.2 54.4 131.7 57.9 217.3z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.sections", "navigation.expand", "navigation.top", "toc.follow", "content.code.copy", "search.suggest"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>